<template>
	<view class="page">
		<!-- é¡¶éƒ¨è£…é¥°èƒŒæ™¯ -->
		<view class="header-bg">
			<image class="header-bg-image" src="/static/images/background.jpg" mode="aspectFill"></image>
			<view class="header-overlay"></view>
		</view>
		
		<!-- æ ‡é¢˜åŒºåŸŸ -->
		<view class="header">
			<image class="logo" src="/static/images/logo.png" mode="aspectFit"></image>
			<view class="title-container">
				<text class="title">ä¸­è¯ææ™ºèƒ½æœç´¢ç³»ç»Ÿ</text>
				<text class="subtitle">ä¼ æ‰¿åƒå¹´æ™ºæ…§ Â· æ•°å­—ç§‘æŠ€èµ‹èƒ½</text>
			</view>
		</view>
		
		<!-- åŠŸèƒ½å¯¼èˆª -->
		<view class="nav-container">
			<view class="nav-item" :class="{ active: activeTab === 'image' }" @tap="switchTab('image')">
				<view class="nav-icon">
					<text class="iconfont icon-camera"></text>
				</view>
				<text class="nav-text">å›¾åƒè¯†åˆ«</text>
			</view>
			<view class="nav-item" :class="{ active: activeTab === 'search' }" @tap="switchTab('search')">
				<view class="nav-icon">
					<text class="iconfont icon-search"></text>
				</view>
				<text class="nav-text">æ™ºèƒ½æ£€ç´¢</text>
			</view>
			<view class="nav-item" :class="{ active: activeTab === 'ai' }" @tap="switchTab('ai')">
				<view class="nav-icon">
					<text class="iconfont icon-ai"></text>
				</view>
				<text class="nav-text">AIé—®è¯</text>
			</view>
		</view>
		
		<!-- å†…å®¹åŒºåŸŸ -->
		<view class="content-container">
			<!-- å›¾åƒè¯†åˆ«å†…å®¹ -->
			<view v-if="activeTab === 'image'" class="content-section">
				<view class="card">
					<view class="card-body">
						<view class="image-section">
							<view v-if="selectedImage" class="image-preview-container">
								<image class="image-preview" :src="selectedImage" mode="aspectFill"></image>
								<view class="image-overlay" @tap="chooseImage">
									<text class="overlay-text">ç‚¹å‡»æ›´æ¢</text>
								</view>
							</view>
							<view v-else class="image-upload" @tap="chooseImage">
								<view class="upload-icon">
									<text class="iconfont icon-upload"></text>
								</view>
								<text class="upload-text">ä¸Šä¼ ä¸­è¯å›¾ç‰‡</text>
								<text class="upload-desc">æ”¯æŒæ‹ç…§æˆ–ä»ç›¸å†Œé€‰æ‹©</text>
							</view>
						</view>
						
						<view class="action-area">
							<button class="btn-identify" @tap="searchByImage" :disabled="!selectedImage">
								<text class="btn-text">å¼€å§‹è¯†åˆ«</text>
							</button>
							<text class="tips-text">æ‹æ‘„æ¸…æ™°å®Œæ•´çš„è¯æå›¾ç‰‡ï¼Œå¯æé«˜è¯†åˆ«å‡†ç¡®ç‡</text>
						</view>
					</view>
				</view>
				
				<view class="card info-card">
					<view class="card-header">
						<text class="card-title">è¯†åˆ«è¯´æ˜</text>
					</view>
					<view class="card-body">
						<view class="info-item">
							<text class="info-icon iconfont icon-tips"></text>
							<text class="info-text">è¯·å°½é‡åœ¨æ˜äº®ç¯å¢ƒä¸‹æ‹æ‘„è¯æ</text>
						</view>
						<view class="info-item">
							<text class="info-icon iconfont icon-tips"></text>
							<text class="info-text">å•ä¸€è¯æè¯†åˆ«æ•ˆæœæœ€ä½³</text>
						</view>
						<view class="info-item">
							<text class="info-icon iconfont icon-tips"></text>
							<text class="info-text">è¯†åˆ«æˆåŠŸåå¯æŸ¥çœ‹3Dæ¨¡å‹åŠè¯¦ç»†ä¿¡æ¯</text>
						</view>
					</view>
				</view>
			</view>
			
			<!-- æ™ºèƒ½æ£€ç´¢å†…å®¹ -->
			<view v-if="activeTab === 'search'" class="content-section">
				<view class="card">
					<view class="card-body">
						<view class="search-container">
							<view class="search-box">
								<text class="search-icon iconfont icon-search"></text>
								<input 
									class="search-input" 
									type="text" 
									placeholder="è¯·è¾“å…¥ç—‡çŠ¶ã€åŠŸæ•ˆæˆ–è¯æåç§°..." 
									v-model="searchText"
									@confirm="searchByText"
								/>
								<view v-if="searchText" class="clear-icon" @tap="searchText = ''">
									<text class="iconfont icon-clear"></text>
								</view>
							</view>
							
							<button class="btn-search" @tap="searchByText">
								<text class="btn-text">å¼€å§‹æ£€ç´¢</text>
							</button>
						</view>
						
						<view class="slider-container">
							<view class="slider-header">
								<text class="slider-title">ç›¸å…³åº¦é˜ˆå€¼</text>
								<text class="slider-value">{{relevanceThreshold}}%</text>
							</view>
							<slider 
								class="custom-slider" 
								:min="30" 
								:max="95" 
								:step="5" 
								:value="relevanceThreshold"
								activeColor="#8D6E63"
								backgroundColor="#EFEBE9"
								blockColor="#5D4037"
								@change="onThresholdChange"
							/>
							<view class="slider-labels">
								<text class="label-min">è¾ƒå®½æ¾</text>
								<text class="label-max">è¾ƒä¸¥æ ¼</text>
							</view>
						</view>
					</view>
				</view>
				
				<view class="card tags-card">
					<view class="card-header">
						<text class="card-title">å¸¸è§æ£€ç´¢</text>
					</view>
					<view class="card-body">
						<view class="tags-container">
							<view class="tag" v-for="(tag, index) in commonTags" :key="index" @tap="quickSearch(tag)">
								<text class="tag-text">{{tag}}</text>
							</view>
						</view>
					</view>
				</view>
			</view>
			
			<!-- AIé—®è¯å†…å®¹ -->
			<view v-if="activeTab === 'ai'" class="content-section">
				<view class="card chat-card">
					<view class="chat-container">
						<scroll-view scroll-y="true" class="chat-messages" :scroll-top="scrollTop" @scrolltoupper="loadMoreMessages">
							<view class="chat-date">
								<text class="date-text">{{getCurrentDate()}}</text>
							</view>
							
							<view v-for="(msg, index) in chatMessages" :key="index" class="message-wrapper" :class="msg.type">
								<view v-if="msg.type === 'ai'" class="avatar">
									<text class="avatar-text">åŒ»</text>
								</view>
								<view class="message-item" :class="msg.type">
									<view class="message-content">
										<text>{{ msg.content }}</text>
									</view>
									<view v-if="msg.type === 'ai'" class="message-time">
										<text class="time-text">æ™ºèƒ½AI</text>
									</view>
								</view>
							</view>
							
							<view class="message-end" v-if="chatMessages.length > 0"></view>
						</scroll-view>
						
						<view class="chat-input-area">
							<input 
								class="chat-input" 
								type="text" 
								v-model="chatInput"
								placeholder="è¯·è¾“å…¥æ‚¨çš„é—®é¢˜..."
								:disabled="isAiAnswering"
								@confirm="sendQuestion"
							/>
							<view class="chat-actions">
								<button class="btn-voice" :disabled="isAiAnswering">
									<text class="iconfont icon-voice"></text>
								</button>
								<button class="btn-send" :disabled="!chatInput.trim() || isAiAnswering" @tap="sendQuestion">
									<text class="iconfont icon-send"></text>
								</button>
							</view>
						</view>
					</view>
				</view>
				
				<view class="card suggestion-card">
					<view class="card-header">
						<text class="card-title">æ‚¨å¯ä»¥è¿™æ ·é—®</text>
					</view>
					<view class="card-body">
						<view class="suggestion-container">
							<view class="suggestion" v-for="(item, index) in suggestions" :key="index" @tap="usesuggestion(item)">
								<text class="suggestion-text">{{item}}</text>
							</view>
						</view>
					</view>
				</view>
			</view>
		</view>
		
		<!-- åŠ è½½æŒ‡ç¤ºå™¨ -->
		<view v-if="isSearching" class="loading-overlay">
			<view class="loader">
				<view class="loader-circle"></view>
				<view class="loader-text">
					<text>{{loadingText}}</text>
				</view>
			</view>
		</view>
	</view>
</template>

<script>
import { view3DModel, processHerbData } from '../../utils/model3d.js';
import { API_CONFIG, getApiUrl, getUrlWithParams } from '../../config/api.js';

export default {
	data() {
		return {
			activeTab: 'image',
			selectedImage: '',
			searchText: '',
			relevanceThreshold: 60,
			isSearching: false,
			loadingText: 'å¤„ç†ä¸­...',
			chatMessages: [],
			chatInput: '',
			isAiAnswering: false,
			scrollTop: 0,
			commonTags: ['æ¸…çƒ­è§£æ¯’', 'è¡¥æ°”å…»è¡€', 'ç¥›é£æ¹¿', 'å®‰ç¥åŠ©çœ ', 'å¥è„¾èƒƒ', 'æ¶¦è‚ºæ­¢å’³'],
			suggestions: [
				'é‡‘é“¶èŠ±çš„åŠŸæ•ˆä¸ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ',
				'é»„èŠªå’Œå…šå‚å¯ä»¥ä¸€èµ·åƒå—ï¼Ÿ',
				'è¯·ä»‹ç»ä¸€ä¸‹å½“å½’çš„è¯æ€§ç‰¹ç‚¹',
				'æœ‰å“ªäº›è¯æé€‚åˆæ˜¥å­£å…»ç”Ÿï¼Ÿ'
			]
		}
	},
	onLoad() {
		// åˆå§‹åŒ–æ¬¢è¿æ¶ˆæ¯
		if (this.chatMessages.length === 0) {
			this.chatMessages.push({
				type: 'ai',
				content: 'æ‚¨å¥½ï¼Œæˆ‘æ˜¯ä¸­è¯æ™ºèƒ½é¡¾é—®ï¼ŒåŸºäºDeepSeekå¤§è¯­è¨€æ¨¡å‹å¼€å‘ã€‚æˆ‘å¯ä»¥å›ç­”æ‚¨å…³äºä¸­è¯æçš„åŠŸæ•ˆã€ç”¨æ³•ã€ç¦å¿Œç­‰é—®é¢˜ï¼Œè¯·é—®æœ‰ä»€ä¹ˆå¯ä»¥å¸®åŠ©æ‚¨çš„ï¼Ÿ'
			});
		}
		
		// æ¨¡æ‹ŸAPIå»¶è¿Ÿï¼Œå®é™…ä½¿ç”¨æ—¶è¯·åˆ é™¤
		setTimeout(() => {
			uni.hideLoading();
		}, 500);
	},
	methods: {
		// åˆ‡æ¢æ ‡ç­¾é¡µ
		switchTab(tab) {
			this.activeTab = tab;
		},
		
		// å›¾ç‰‡é€‰æ‹©
		chooseImage() {
			uni.chooseImage({
				count: 1,
				sizeType: ['original', 'compressed'],
				sourceType: ['album', 'camera'],
				success: (res) => {
					console.log('é€‰æ‹©å›¾ç‰‡æˆåŠŸ:', res);
					this.selectedImage = res.tempFilePaths[0];
				},
				fail: (err) => {
					console.error('é€‰æ‹©å›¾ç‰‡å¤±è´¥:', err);
				}
			});
		},
		
		// å›¾ç‰‡æœç´¢
		searchByImage() {
			if (!this.selectedImage) {
				uni.showToast({
					title: 'è¯·å…ˆé€‰æ‹©å›¾ç‰‡',
					icon: 'none',
					duration: 2000
				});
				return;
			}
			
			this.isSearching = true;
			this.loadingText = 'æ­£åœ¨è¯†åˆ«è¯æ...';
			
			uni.uploadFile({
				url: getApiUrl(API_CONFIG.SEARCH.IMAGE),
				filePath: this.selectedImage,
				name: 'file',
				formData: {
					'min_area_ratio': '0.1',
					'response_type': 'json'
				},
				success: (res) => {
					const responseData = JSON.parse(res.data);
					console.log('å›¾ç‰‡æœç´¢ç»“æœ:', responseData);
					
					if (responseData.herbs && responseData.herbs.length > 0) {
						const topResult = responseData.herbs[0];
						console.log('æœ€ç›¸ä¼¼çš„è¯æ:', topResult.name);
						
						const herbData = processHerbData(topResult);
						this.view3DModel(herbData);
					} else {
						uni.showModal({
							title: 'æœªè¯†åˆ«å‡ºè¯æ',
							content: 'å¾ˆæŠ±æ­‰,æœªèƒ½è¯†åˆ«å‡ºå›¾ç‰‡ä¸­çš„ä¸­è¯æã€‚\n\næ‚¨å¯ä»¥å°è¯•:\n1. æ‹æ‘„æ›´æ¸…æ™°çš„å›¾ç‰‡\n2. è°ƒæ•´å…‰çº¿,é¿å…åå…‰æˆ–é˜´å½±\n3. å°è¯•ä¸åŒè§’åº¦æ‹æ‘„\n4. ä½¿ç”¨æ–‡å­—æœç´¢åŠŸèƒ½',
							confirmText: 'æˆ‘çŸ¥é“äº†',
							showCancel: false
						});
					}
				},
				fail: (err) => {
					console.error('å›¾ç‰‡ä¸Šä¼ è¯·æ±‚å¤±è´¥:', err);
					uni.showToast({
						title: 'ç½‘ç»œè¯·æ±‚å¤±è´¥',
						icon: 'none',
						duration: 2000
					});
				},
				complete: () => {
					this.isSearching = false;
				}
			});
		},
		
		// æ–‡æœ¬æœç´¢
		searchByText() {
			if (!this.searchText.trim()) {
				uni.showToast({
					title: 'è¯·è¾“å…¥æœç´¢å…³é”®è¯',
					icon: 'none',
					duration: 2000
				});
				return;
			}
			
			this.isSearching = true;
			this.loadingText = 'æ­£åœ¨æ£€ç´¢è¯æ...';
			
			const apiUrl = getUrlWithParams(API_CONFIG.SEARCH.TEXT, {
				query: this.searchText,
				response_type: 'json'
			});
			
			uni.request({
				url: apiUrl,
				method: 'GET',
				success: (res) => {
					console.log('æ–‡æœ¬æœç´¢ç»“æœ:', res.data);
					
					if (res.data.herbs && res.data.herbs.length > 0) {
						const topResult = res.data.herbs[0];
						console.log('æœ€ç›¸ä¼¼çš„è¯æ:', topResult.name);
						
						const herbData = processHerbData(topResult);
						this.view3DModel(herbData);
					} else {
						uni.showModal({
							title: 'æœªæ‰¾åˆ°åŒ¹é…è¯æ',
							content: 'å¾ˆæŠ±æ­‰,æœªèƒ½æ‰¾åˆ°åŒ¹é…çš„ä¸­è¯æã€‚\n\næ‚¨å¯ä»¥å°è¯•:\n1. ä½¿ç”¨ä¸åŒçš„å…³é”®è¯\n2. å°è¯•æ›´å…·ä½“çš„ç—‡çŠ¶æˆ–åŠŸæ•ˆæè¿°\n3. ä½¿ç”¨å›¾ç‰‡æœç´¢åŠŸèƒ½',
							confirmText: 'æˆ‘çŸ¥é“äº†',
							showCancel: false
						});
					}
				},
				fail: (err) => {
					console.error('æ–‡æœ¬æœç´¢è¯·æ±‚å¤±è´¥:', err);
					uni.showToast({
						title: 'ç½‘ç»œè¯·æ±‚å¤±è´¥',
						icon: 'none',
						duration: 2000
					});
				},
				complete: () => {
					this.isSearching = false;
				}
			});
		},
		
		// å¿«é€Ÿæœç´¢æ ‡ç­¾
		quickSearch(tag) {
			this.searchText = tag;
			this.searchByText();
		},
		
		// é˜ˆå€¼å˜åŒ–
		onThresholdChange(e) {
			this.relevanceThreshold = e.detail.value;
		},
		
		// ä½¿ç”¨å»ºè®®é—®é¢˜
		usesuggestion(suggestion) {
			this.chatInput = suggestion;
			this.sendQuestion();
		},
		
		// å‘é€é—®é¢˜
		sendQuestion() {
			if (!this.chatInput.trim() || this.isAiAnswering) return;
			
			this.chatMessages.push({
				type: 'user',
				content: this.chatInput
			});
			
			const question = this.chatInput;
			this.chatInput = '';
			this.scrollToBottom();
			
			this.isAiAnswering = true;
			this.loadingText = 'AIæ€è€ƒä¸­...';
			this.chatMessages.push({
				type: 'ai',
				content: 'æ€è€ƒä¸­...'
			});
			
			this.getAiAnswer(question);
		},
		
		// è·å–AIå›ç­”
		getAiAnswer(question) {
			console.log('AIé—®è¯APIè¯·æ±‚:', question);
			
			const formData = {
				query: question
			};
			
			uni.request({
				url: getApiUrl(API_CONFIG.AI.QUERY),
				method: 'POST',
				data: formData,
				header: {
					'content-type': 'application/x-www-form-urlencoded'
				},
				success: (res) => {
					console.log('AIå›ç­”APIå“åº”:', res);
					
					// ç§»é™¤"æ€è€ƒä¸­"æ¶ˆæ¯
					this.chatMessages.pop();
					
					if (res.statusCode === 200 && res.data && res.data.answer) {
						this.chatMessages.push({
							type: 'ai',
							content: res.data.answer
						});
					} else {
						this.chatMessages.push({
							type: 'ai',
							content: 'æŠ±æ­‰ï¼Œæˆ‘æš‚æ—¶æ— æ³•å›ç­”æ‚¨çš„é—®é¢˜ã€‚è¯·ç¨åå†è¯•æˆ–æ¢ä¸€ä¸ªé—®é¢˜ã€‚'
						});
					}
				},
				fail: (err) => {
					console.error('AIå›ç­”è¯·æ±‚å¤±è´¥:', err);
					
					// ç§»é™¤"æ€è€ƒä¸­"æ¶ˆæ¯
					this.chatMessages.pop();
					
					this.chatMessages.push({
						type: 'ai',
						content: 'ç½‘ç»œè¯·æ±‚å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ‚¨çš„ç½‘ç»œè¿æ¥åé‡è¯•ã€‚'
					});
				},
				complete: () => {
					this.isAiAnswering = false;
					this.scrollToBottom();
				}
			});
		},
		
		// æ»šåŠ¨åˆ°åº•éƒ¨
		scrollToBottom() {
			this.$nextTick(() => {
				this.scrollTop = 100000;
			});
		},
		
		// åŠ è½½æ›´å¤šæ¶ˆæ¯ï¼ˆé¢„ç•™åŠŸèƒ½ï¼‰
		loadMoreMessages() {
			console.log('åŠ è½½æ›´å¤šå†å²æ¶ˆæ¯');
			// è¿™é‡Œå¯ä»¥å®ç°åŠ è½½æ›´å¤šå†å²æ¶ˆæ¯çš„é€»è¾‘
		},
		
		// è·å–å½“å‰æ—¥æœŸ
		getCurrentDate() {
			const now = new Date();
			const year = now.getFullYear();
			const month = now.getMonth() + 1;
			const day = now.getDate();
			return `${year}å¹´${month}æœˆ${day}æ—¥`;
		},
		
		// æŸ¥çœ‹3Dæ¨¡å‹
		view3DModel(herb) {
			view3DModel(herb).catch(err => {
				console.error('æ‰“å¼€3Dæ¨¡å‹å¤±è´¥:', err);
				uni.showToast({
					title: 'æ¨¡å‹åŠ è½½å¤±è´¥',
					icon: 'none',
					duration: 2000
				});
			});
		}
	}
}
</script>

<style>
/* é¡µé¢åŸºç¡€æ ·å¼ */
.page {
	min-height: 100vh;
	background-color: #f5f0e7;
	position: relative;
}

/* é¡¶éƒ¨èƒŒæ™¯ */
.header-bg {
	position: absolute;
	top: 0;
	left: 0;
	right: 0;
	height: 420rpx;
	overflow: hidden;
	z-index: 0;
}

.header-bg-image {
	width: 100%;
	height: 100%;
	opacity: 0.4;
}

.header-overlay {
	position: absolute;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	background: linear-gradient(to bottom, rgba(139, 69, 19, 0.7), rgba(139, 69, 19, 0));
}

/* æ ‡é¢˜åŒºåŸŸ */
.header {
	position: relative;
	padding: 30rpx;
	display: flex;
	align-items: center;
	z-index: 1;
}

.logo {
	width: 100rpx;
	height: 100rpx;
	border-radius: 50%;
	background-color: rgba(255, 255, 255, 0.9);
	margin-right: 20rpx;
	box-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.1);
}

.title-container {
	flex: 1;
}

.title {
	font-size: 36rpx;
	font-weight: bold;
	color: #ffffff;
	text-shadow: 0 2rpx 4rpx rgba(0, 0, 0, 0.3);
}

.subtitle {
	font-size: 24rpx;
	color: #f8f8f8;
	margin-top: 6rpx;
	opacity: 0.9;
}

/* å¯¼èˆªæ  */
.nav-container {
	display: flex;
	background-color: #fff;
	padding: 10rpx 20rpx;
	border-radius: 16rpx;
	margin: 0 30rpx;
	box-shadow: 0 8rpx 20rpx rgba(0, 0, 0, 0.1);
	position: relative;
	z-index: 10;
}

.nav-item {
	flex: 1;
	display: flex;
	flex-direction: column;
	align-items: center;
	padding: 20rpx 0;
	border-radius: 12rpx;
	transition: all 0.3s;
}

.nav-item.active {
	background-color: rgba(141, 110, 99, 0.15);
}

.nav-icon {
	width: 80rpx;
	height: 80rpx;
	border-radius: 50%;
	background-color: #fff;
	display: flex;
	justify-content: center;
	align-items: center;
	margin-bottom: 8rpx;
	box-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.06);
}

.nav-item.active .nav-icon {
	background-color: #8D6E63;
}

.iconfont {
	font-size: 44rpx;
	color: #8D6E63;
}

.nav-item.active .iconfont {
	color: #fff;
}

.nav-text {
	font-size: 24rpx;
	color: #5D4037;
}

/* å†…å®¹åŒºåŸŸ */
.content-container {
	padding: 30rpx;
	padding-top: 50rpx;
}

.content-section {
	padding-bottom: 50rpx;
}

/* å¡ç‰‡æ ·å¼ */
.card {
	background-color: #fff;
	border-radius: 16rpx;
	overflow: hidden;
	box-shadow: 0 4rpx 16rpx rgba(0, 0, 0, 0.06);
	margin-bottom: 30rpx;
}

.card-header {
	padding: 24rpx 30rpx;
	border-bottom: 1rpx solid rgba(0, 0, 0, 0.05);
}

.card-title {
	font-size: 28rpx;
	font-weight: bold;
	color: #5D4037;
}

.card-body {
	padding: 30rpx;
}

/* å›¾åƒè¯†åˆ«éƒ¨åˆ† */
.image-section {
	margin-bottom: 30rpx;
}

.image-preview-container {
	position: relative;
	width: 100%;
	height: 400rpx;
	border-radius: 12rpx;
	overflow: hidden;
}

.image-preview {
	width: 100%;
	height: 100%;
}

.image-overlay {
	position: absolute;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	background-color: rgba(0, 0, 0, 0.3);
	display: flex;
	justify-content: center;
	align-items: center;
	opacity: 0;
	transition: opacity 0.3s;
}

.image-overlay:active {
	opacity: 1;
}

.overlay-text {
	color: white;
	font-size: 28rpx;
	padding: 16rpx 32rpx;
	background-color: rgba(0, 0, 0, 0.5);
	border-radius: 40rpx;
}

.image-upload {
	width: 100%;
	height: 400rpx;
	border: 2rpx dashed #BCAAA4;
	border-radius: 12rpx;
	display: flex;
	flex-direction: column;
	justify-content: center;
	align-items: center;
	background-color: #f9f5f2;
}

.upload-icon {
	font-size: 80rpx;
	color: #BCAAA4;
	margin-bottom: 20rpx;
}

.upload-text {
	font-size: 32rpx;
	color: #8D6E63;
	margin-bottom: 8rpx;
}

.upload-desc {
	font-size: 24rpx;
	color: #A1887F;
}

.action-area {
	display: flex;
	flex-direction: column;
	align-items: center;
}

.btn-identify {
	width: 100%;
	height: 88rpx;
	background: linear-gradient(135deg, #A1887F, #8D6E63);
	border-radius: 44rpx;
	display: flex;
	justify-content: center;
	align-items: center;
	box-shadow: 0 4rpx 12rpx rgba(161, 136, 127, 0.3);
	border: none;
}

.btn-identify:active {
	background: linear-gradient(135deg, #8D6E63, #6D4C41);
	transform: translateY(2rpx);
}

.btn-identify[disabled] {
	background: #D7CCC8;
	box-shadow: none;
}

.btn-text {
	color: white;
	font-size: 30rpx;
	font-weight: 500;
}

.tips-text {
	font-size: 24rpx;
	color: #A1887F;
	margin-top: 20rpx;
	text-align: center;
}

/* æç¤ºå¡ç‰‡ */
.info-card {
	background-color: #FFF8E1;
}

.info-item {
	display: flex;
	align-items: center;
	margin-bottom: 16rpx;
}

.info-item:last-child {
	margin-bottom: 0;
}

.info-icon {
	font-size: 32rpx;
	color: #FFB300;
	margin-right: 16rpx;
}

.info-text {
	font-size: 26rpx;
	color: #5D4037;
}

/* æ™ºèƒ½æ£€ç´¢éƒ¨åˆ† */
.search-container {
	margin-bottom: 30rpx;
}

.search-box {
	display: flex;
	align-items: center;
	background-color: #F5F5F5;
	border-radius: 40rpx;
	padding: 0 20rpx;
	margin-bottom: 20rpx;
}

.search-icon {
	font-size: 36rpx;
	color: #8D6E63;
	margin-right: 10rpx;
}

.search-input {
	flex: 1;
	height: 80rpx;
	padding: 0 10rpx;
	font-size: 28rpx;
	color: #5D4037;
}

.clear-icon {
	padding: 10rpx;
}

.btn-search {
	width: 100%;
	height: 88rpx;
	background: linear-gradient(135deg, #A1887F, #8D6E63);
	border-radius: 44rpx;
	display: flex;
	justify-content: center;
	align-items: center;
	box-shadow: 0 4rpx 12rpx rgba(161, 136, 127, 0.3);
	border: none;
}

.btn-search:active {
	background: linear-gradient(135deg, #8D6E63, #6D4C41);
	transform: translateY(2rpx);
}

.slider-container {
	margin-top: 40rpx;
}

.slider-header {
	display: flex;
	justify-content: space-between;
	align-items: center;
	margin-bottom: 20rpx;
}

.slider-title {
	font-size: 28rpx;
	color: #5D4037;
	font-weight: 500;
}

.slider-value {
	font-size: 28rpx;
	color: #8D6E63;
	font-weight: bold;
}

.custom-slider {
	margin-bottom: 12rpx;
}

.slider-labels {
	display: flex;
	justify-content: space-between;
}

.label-min, .label-max {
	font-size: 24rpx;
	color: #A1887F;
}

/* æ ‡ç­¾å¡ç‰‡ */
.tags-container {
	display: flex;
	flex-wrap: wrap;
	margin: -8rpx;
}

.tag {
	background-color: #EFEBE9;
	border-radius: 30rpx;
	padding: 12rpx 24rpx;
	margin: 8rpx;
}

.tag-text {
	font-size: 24rpx;
	color: #5D4037;
}

/* AIé—®è¯éƒ¨åˆ† */
.chat-card {
	padding: 0;
	margin-bottom: 30rpx;
	overflow: hidden;
}

.chat-container {
	display: flex;
	flex-direction: column;
	height: 800rpx;
}

.chat-messages {
	flex: 1;
	padding: 30rpx;
	background-color: #f2f2f2;
}

.chat-date {
	text-align: center;
	margin-bottom: 30rpx;
}

.date-text {
	font-size: 24rpx;
	color: #9E9E9E;
	background-color: rgba(0, 0, 0, 0.05);
	padding: 8rpx 20rpx;
	border-radius: 20rpx;
}

.message-wrapper {
	display: flex;
	margin-bottom: 30rpx;
	clear: both;
}

.message-wrapper.user {
	flex-direction: row-reverse;
}

.avatar {
	width: 60rpx;
	height: 60rpx;
	border-radius: 30rpx;
	background-color: #8D6E63;
	display: flex;
	justify-content: center;
	align-items: center;
	margin-right: 16rpx;
}

.avatar-text {
	color: white;
	font-size: 24rpx;
	font-weight: bold;
}

.message-item {
	max-width: 70%;
}

.message-content {
	padding: 16rpx 24rpx;
	border-radius: 4rpx 20rpx 20rpx 20rpx;
	background-color: white;
	box-shadow: 0 2rpx 8rpx rgba(0, 0, 0, 0.1);
}

.message-item.user .message-content {
	border-radius: 20rpx 4rpx 20rpx 20rpx;
	background-color: #DCE775;
	box-shadow: 0 2rpx 8rpx rgba(220, 231, 117, 0.3);
}

.message-time {
	margin-top: 8rpx;
}

.time-text {
	font-size: 22rpx;
	color: #9E9E9E;
}

.message-end {
	height: 20rpx;
}

.chat-input-area {
	display: flex;
	padding: 20rpx;
	border-top: 1rpx solid #EEEEEE;
	background-color: white;
}

.chat-input {
	flex: 1;
	height: 80rpx;
	background-color: #F5F5F5;
	border-radius: 40rpx;
	padding: 0 30rpx;
	font-size: 28rpx;
	margin-right: 20rpx;
}

.chat-actions {
	display: flex;
}

.btn-voice, .btn-send {
	width: 80rpx;
	height: 80rpx;
	border-radius: 40rpx;
	display: flex;
	justify-content: center;
	align-items: center;
	margin-left: 10rpx;
	background-color: #F5F5F5;
	border: none;
}

.btn-send {
	background-color: #8D6E63;
}

.btn-send[disabled] {
	background-color: #D7CCC8;
}

.btn-send .iconfont {
	color: white;
}

/* å»ºè®®å¡ç‰‡ */
.suggestion-container {
	display: flex;
	flex-direction: column;
}

.suggestion {
	background-color: #F5F5F5;
	border-radius: 12rpx;
	padding: 20rpx;
	margin-bottom: 16rpx;
}

.suggestion:last-child {
	margin-bottom: 0;
}

.suggestion-text {
	font-size: 26rpx;
	color: #5D4037;
}

/* åŠ è½½æŒ‡ç¤ºå™¨ */
.loading-overlay {
	position: fixed;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	background-color: rgba(0, 0, 0, 0.7);
	display: flex;
	justify-content: center;
	align-items: center;
	z-index: 999;
}

.loader {
	display: flex;
	flex-direction: column;
	align-items: center;
}

.loader-circle {
	width: 80rpx;
	height: 80rpx;
	border: 4rpx solid rgba(255, 255, 255, 0.3);
	border-radius: 50%;
	border-top-color: white;
	animation: spin 1s linear infinite;
}

@keyframes spin {
	to { transform: rotate(360deg); }
}

.loader-text {
	margin-top: 30rpx;
	color: white;
	font-size: 28rpx;
}

/* æ¨¡æ‹Ÿå­—ä½“å›¾æ ‡ç±» - å®é™…é¡¹ç›®ä¸­è¯·ä½¿ç”¨çœŸå®å­—ä½“å›¾æ ‡ */
.iconfont.icon-camera:before { content: "ğŸ“·"; }
.iconfont.icon-search:before { content: "ğŸ”"; }
.iconfont.icon-ai:before { content: "ğŸ¤–"; }
.iconfont.icon-upload:before { content: "ğŸ“¤"; }
.iconfont.icon-tips:before { content: "ğŸ’¡"; }
.iconfont.icon-clear:before { content: "âœ–"; }
.iconfont.icon-voice:before { content: "ğŸ¤"; }
.iconfont.icon-send:before { content: "ğŸ“¤"; }
</style>
